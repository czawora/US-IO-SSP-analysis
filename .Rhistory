opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl.png"), expand = 10)
industry_codes63_df %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl.png"), expand = 10)
library(tidyverse)
library(readxl)
library(glue)
library(ggbump)
library(janitor)
library(RColorBrewer)
library(cowplot)
library(gt)
here::i_am("code/analysis.Rmd")
library(here)
proj_root <- here()
industry_codes63_df %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl.png"), expand = 10)
industry_codes63_df %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
filter(code != code_match47 | exogenous47 != exogenous63) %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl.png"), expand = 10)
industry_codes63_df %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
filter(code != code_match47 | exogenous47 | exogenous63) %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl.png"), expand = 10)
industry_codes63_df %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
filter((code != code_match47) | exogenous47 | exogenous63) %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl.png"), expand = 10)
industry_codes63_df %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
filter((code != code_match47) | exogenous47 != "" | exogenous63 != "") %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl.png"), expand = 10)
industry_codes63_df %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
#filter((code != code_match47) | exogenous47 != "" | exogenous63 != "") %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl.png"), expand = 10)
for (i in 1:3){
industry_codes63_df %>%
filter(row_number >= (i-1)*25, row_number <i*25) %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
#filter((code != code_match47) | exogenous47 != "" | exogenous63 != "") %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl{i}.png"), expand = 10)
}
industry_codes63_df %>%
filter(row_number() >= (i-1)*25, row_number() <i*25) %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
#filter((code != code_match47) | exogenous47 != "" | exogenous63 != "") %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl{i}.png"), expand = 10)
for (i in 1:3){
industry_codes63_df %>%
filter(row_number() >= (i-1)*25, row_number() <i*25) %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
#filter((code != code_match47) | exogenous47 != "" | exogenous63 != "") %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl{i}.png"), expand = 10)
}
for (i in 1:4){
industry_codes63_df %>%
filter(row_number() >= (i-1)*20, row_number() <i*20) %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
#filter((code != code_match47) | exogenous47 != "" | exogenous63 != "") %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl{i}.png"), expand = 10)
}
nrow(industry_codes63_df)
65/18
for (i in 1:4){
industry_codes63_df %>%
filter(row_number() >= (i-1)*18, row_number() <i*18) %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
#filter((code != code_match47) | exogenous47 != "" | exogenous63 != "") %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl{i}.png"), expand = 10)
}
65/5
for (i in 1:5){
industry_codes63_df %>%
filter(row_number() >= (i-1)*13, row_number() <i*13) %>%
select(code, name, code_match47, name_match47) %>%
mutate(
name = str_replace_all(name, "_", " "),
name_match47 = str_replace_all(name_match47, "_", " "),
exogenous47 = if_else(code_match47 %in% exogenous_industry_codes47, "✔", "") ,
exogenous63 = if_else(code %in% exogenous_industry_codes63, "✔", "")
) %>%
#filter((code != code_match47) | exogenous47 != "" | exogenous63 != "") %>%
select(
`NAICS Code` = code,
Industry = name,
Exogenous = exogenous63,
`NAICS Code ` = code_match47,
`Industry ` = name_match47,
`Exogenous ` = exogenous47
) %>%
gt() %>%
tab_spanner(
label = "Industries 1963-96",
columns = c(
`NAICS Code`, Industry, Exogenous
)
) %>%
tab_spanner(
label = "Aggregation up to 1947 industry set",
columns = c(
`NAICS Code `, `Industry `, `Exogenous `
)
) %>%
cols_width(
starts_with("Industry") ~ px(150),
everything() ~ px(100)
) %>%
opt_stylize(style = 5, color = "gray") %>%
cols_align(align = "center") %>%
gtsave(glue("{proj_root}/results/industry_agg_tbl{i}.png"), expand = 10)
}
